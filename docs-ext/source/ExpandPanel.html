<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js">Ext.define(&#39;CpsiMapview.plugin.ExpandPanel&#39;, {
    extend: &#39;Ext.plugin.Abstract&#39;,
    alias: &#39;plugin.cmv_expand_panel&#39;,

    layout: &#39;fit&#39;,

<span id='global-property-parentPanel'>    /**
</span>     * This is the parent panel that the expanded panel will be reinserted after maximizing. By default is set to the
     * direct parent. A parent panel needs to exist for this plugin to work.
     * If a window should be made expandable use the config `maximizable` instead.
     */
    parentPanel: null,

<span id='global-property-positionInParentPanel'>    /**
</span>     * The original position of the panel in the parent. Will be calculated if the panel can be found in the items of
     * the direct parent.
     */
    positionInParentPanel: 0,

    init: function () {
        var me = this;
        var cmp = me.getCmp();

        me.maxTool = Ext.create(&#39;Ext.panel.Tool&#39;, {
            type: &#39;maximize&#39;,
            handler: function () {
                me.expand();
            }
        });

        cmp.addTool(me.maxTool);

        me.callParent();
    },

<span id='global-method-expand'>    /**
</span>     * Creates a maximized window containing the panel.
     */
    expand: function () {
        var me = this;
        var cmp = me.getCmp();

        if (me.parentPanel === null) {
            me.parentPanel = cmp.up();
        }

        if (!me.parentPanel || !me.parentPanel.isXType(&#39;panel&#39;)) {
            throw new Error(&#39;the property parentPanel has to be of xtype `panel`&#39;);
        }

        cmp.fireEvent(&#39;beforeexpand&#39;, cmp);
        me.parentPanel.fireEvent(&#39;beforeexpand&#39;, cmp);

        var index = me.parentPanel.items.items.indexOf(cmp);
        me.positionInParentPanel = index &gt; -1 ? index : me.positionInParentPanel;

        me.maxedWin = Ext.create(&#39;Ext.window.Window&#39;, {
            maximized: true,
            closable: false,
            tools: [
                {
                    type: &#39;restore&#39;,
                    handler: function () {
                        me.restore();
                    }
                }
            ],

            items: [
                cmp
            ]
        });

        me.maxedWin.show();

        me.maxTool.hide();

        cmp.fireEvent(&#39;expand&#39;, cmp);
        me.parentPanel.fireEvent(&#39;expand&#39;, cmp);
    },

<span id='global-method-restore'>    /**
</span>     * Reinserts the maximized panel it its original parent.
     */
    restore: function () {
        var me = this;
        var cmp = this.getCmp();

        me.parentPanel.insert(me.positionInParentPanel, cmp);
        me.maxTool.show();

        cmp.fireEvent(&#39;restore&#39;, cmp);
        me.parentPanel.fireEvent(&#39;restore&#39;, cmp);

        setTimeout(function () {
            me.maxedWin.close();
        }, 0);


    }
});
</pre>
</body>
</html>
