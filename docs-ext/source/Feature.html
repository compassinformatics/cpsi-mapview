<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js"><span id='CpsiMapview-field-Feature'>/**
</span>* A custom field for linking OpenLayers features
* The field handles loading GeoJSON from a web service into a store associated with the field.
* The field value itself will be set to an array of OpenLayers features.
* The field value is set both in the convert function below, and also by
* CpsiMapview.model.FeatureStoreMixin with the `add`, `clear`, and `remove`
* listeners on the FeatureStore. This triggers any field validation which may be
* set.
*/
Ext.define(&#39;CpsiMapview.field.Feature&#39;, {
    extend: &#39;Ext.data.field.Field&#39;,

    alias: &#39;data.field.feature&#39;,

<span id='CpsiMapview-field-Feature-property-persist'>    // ensure the data is sent to the server
</span>    // https://docs.sencha.com/extjs/6.7.0/modern/Ext.data.field.Field.html#cfg-persist
    persist: true,

<span id='CpsiMapview-field-Feature-property-allowNull'>    allowNull: true,
</span>
<span id='CpsiMapview-field-Feature-method-convert'>    /**
</span>     * Load GeoJSON features into the field&#39;s feature store
     */
    convert: function (data, rec) {

        var me = this;
        var features = null;
        var featureStore = rec.featureStores ? rec.featureStores[me.name] : null;

        if (featureStore &amp;&amp; data) {
            features = (new ol.format.GeoJSON().readFeatures(data));
            // wrap an edit session around updating the field when first loaded
            // to ensure the model is not marked as dirty
            rec.beginEdit();
            var layerSource = featureStore.layer.getSource();
            layerSource.getFeaturesCollection().clear();
            layerSource.addFeatures(features);
            rec.endEdit();
        }

        return features;
    },

<span id='CpsiMapview-field-Feature-method-createStyle'>    /**
</span>    * Create a default style for the layer associated with the feature field
    *
    * @template
    */
    createStyle: Ext.emptyFn,

<span id='CpsiMapview-field-Feature-method-createSelectStyle'>    /**
</span>    * Create a selection style for the layer associated with the feature field
    *
    * @template
    */
    createSelectStyle: Ext.emptyFn

});
</pre>
</body>
</html>
